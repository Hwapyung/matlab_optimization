% Goldstein-Price function
% V(x,y) = [1+(x+y+1)^2(19-14x+3x^2-14y+6xy+3y^2)][30+(2x-3y)^2(18-32x+12x^2+48y-36xy+27y^2)]
J = @(x,y) (1 + (x + y + 1).^2.*(19 - 14*x + 3*x.^2 - 14*y + 6*x.*y + 3*y.^2)) ... 
    .*(30 + (2*x - 3*y).^2.*(18 - 32*x + 12*x.^2 + 48*y - 36*x.*y + 27*y.^2));
Jx = @(x,y) (30 + (2*x - 3*y).^2.*(18 - 32*x + 12*x.^2 + 48*y - 36*x.*y + 27*y.^2)) ...
    .*(2*(x+y+1).*(19-14*x+3*x.^2-14*y+6*x.*y+3*y.^2)+2*(x+y+1).^2.*(-7+3*x+3*y)) ...
    + (1 + (x + y + 1).^2.*(19 - 14*x + 3*x.^2 - 14*y + 6*x.*y + 3*y.^2)) ...
    .*(4*(2*x-3*y).*(18-32*x+12*x.^2+48*y-36*x.*y+27*y.^2)+4*(2*x-3*y).^2.*(-8+6*x-9*y));
Jy = @(x,y) (30 + (2*x - 3*y).^2.*(18 - 32*x + 12*x.^2 + 48*y - 36*x.*y + 27*y.^2)) ...
    .*(2*(x+y+1).^2.*(-7+3*x+3*y)+2*(x+y+1).*(19-14*x+3*x.^2-14*y+6*x.*y+3*y.^2)) ...
    + (1 + (x + y + 1).^2.*(19 - 14*x + 3*x.^2 - 14*y + 6*x.*y + 3*y.^2)) ...
    .*(-6*(2*x-3*y).*(18-32*x+12*x.^2+48*y-36*x.*y+27*y.^2)+6*(2*x-3*y).^2.*(8-6*x+9*y));
xopt=0; yopt=-1; zopt=3;
xmin = -2; xmax = 2;
ymin = -2; ymax = 2;
x0 = -1.739; y0=2;
fig_view=([-51,12]);
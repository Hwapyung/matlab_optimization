% Beale's function
% J(x,y) = 100(y-x^2)^2 + (x-1)^2
J = @(x,y) (1.5 - x + x.*y).^2 + (2.25 - x + x.*y.^2).^2 + (2.625 - x + x.*y.^3).^2;
Jx= @(x,y) 2*(1.5 - x + x.*y).*(y-1) + 2*(2.25 - x + x.*y.^2).*(y.^2-1) + 2*(2.625 - x + x.*y.^3).*(y.^3-1);
Jy= @(x,y) 2*(1.5 - x + x.*y).*x + 4*(2.25 - x + x.*y.^2).*x.*y + 6*(2.625 - x + x.*y.^3).*x.*y.^2;
xopt=3; yopt=0.5; zopt=0;
xmin = -4.5; xmax = 4.5;
ymin = -4.5; ymax = 4.5;
x0=-3.5; y0=-3.5;
fig_view=([93,46]);